{% extends "app_base.html" %}

{% block page_content %}
<div class="page-content" style="min-height:257px">
    <h3 class="page-title">
        MES Dashboard<small> realtime statistics and more</small>
    </h3>
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <i class="fa fa-home"></i>
                <a href="index.html">Home</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="#">Production Tracking</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="#">Vivas Lotus S3</a>
                <i class="fa fa-angle-right"></i>
            </li>
        </ul>
        <div class="page-toolbar">
        </div>
    </div>
    <!-- END PAGE HEADER-->
    <!-- BEGIN DASHBOARD STATS -->
    <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat blue-madison">
                <div class="visual">
                    <i class="fa fa-comments"></i>
                </div>
                <div class="details">
                    <div class="number">
                        <span id="finished_number">0</span>
                    </div>
                    <div class="desc">
                        Finished Products
                    </div>
                </div>
                <a class="more" href="javascript:;">
                    View more <i class="m-icon-swapright m-icon-white"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat red-intense">
                <div class="visual">
                    <i class="fa fa-bar-chart-o"></i>
                </div>
                <div class="details">
                    <div class="number">
                        <span id="error_number">0</span>
                    </div>
                    <div class="desc">
                        Errors
                    </div>
                </div>
                <a class="more" href="javascript:;">
                    View more <i class="m-icon-swapright m-icon-white"></i>
                </a>
            </div>
        </div>
    </div>
    <!-- END DASHBOARD STATS -->
    <div class="clearfix">
    </div>

</div>
</div>
{% endblock %}


{% block page_scripts %}
<script src="http://localhost:8090/socket.io/socket.io.js"></script>
<script>
  var socket = io('http://localhost:8090');
  socket.on('finished_product_event',function(msg) {
  console.log(msg);
    var span = $('#finished_number');

    var number = parseInt(span.text());
    console.log(number);
    span.text(number+1);
  });
  socket.on('error_product_event',function(msg) {
  console.log(msg);
    var span = $('#error_number');

    var number = parseInt(span.text());
    console.log(number);
    span.text(number+1);
  });
</script>
{% endblock %}